# ν•¨μ νΈμ¶μ„ μ„ν• λ¨λΈ νμΈνλ‹ [[fine-tuning]]

μ΄μ  μ²« λ²μ§Έ ν•¨μ νΈμ¶ λ¨λΈμ„ νμΈνλ‹ν•  μ¤€λΉ„κ°€ λμ—μµλ‹λ‹¤ π”¥.

## ν•¨μ νΈμ¶ λ¨λΈμ„ μ–΄λ–»κ² ν•™μµμ‹ν‚¬κΉμ”?

> μ •λ‹µ: **λ°μ΄ν„°**κ°€ ν•„μ”ν•©λ‹λ‹¤

λ¨λΈ ν•™μµ κ³Όμ •μ€ μ„Έ λ‹¨κ³„λ΅ λ‚λ μ μμµλ‹λ‹¤:

1. **λ¨λΈμ„ λ€λ‰μ λ°μ΄ν„°λ΅ μ‚¬μ „ ν•™μµ**ν•©λ‹λ‹¤. μ΄ λ‹¨κ³„μ κ²°κ³Όλ” **μ‚¬μ „ ν•™μµλ λ¨λΈ**μ…λ‹λ‹¤. μλ¥Ό λ“¤μ–΄ [google/gemma-2-2b](https://huggingface.co/google/gemma-2-2b)λ” κΈ°λ³Έ λ¨λΈλ΅, κ°•λ ¥ν• μ§€μΉ¨ λ”°λ¥΄κΈ° λ¥λ ¥ μ—†μ΄ **λ‹¤μ ν† ν° μμΈ΅**λ§ ν•  μ μμµλ‹λ‹¤.
2. λ€ν™”ν• λ¨λΈλ΅ ν™μ©ν•λ ¤λ©΄ μ΄ν›„ **νμΈνλ‹**μ„ ν†µν•΄ μ§€μΉ¨μ„ λ”°λ¥΄λ„λ΅ ν•™μµμ‹μΌμ•Ό ν•©λ‹λ‹¤. μ΄ λ‹¨κ³„λ” λ¨λΈ μ μ‘μλ‚ μ¤ν”μ†μ¤ μ»¤λ®¤λ‹ν‹°, λλ” μ—¬λ¬λ¶„μ΄ μ§μ ‘ μν–‰ν•  μ μμµλ‹λ‹¤. μλ΅ [google/gemma-2-2b-it](https://huggingface.co/google/gemma-2-2b-it)μ€ Gemma ν”„λ΅μ νΈ ν€μ΄ μ§€μΉ¨ μ¤€μλ¥Ό μ„ν•΄ νμΈνλ‹ν• λ¨λΈμ…λ‹λ‹¤.
3. λ§μ§€λ§‰μΌλ΅ λ¨λΈμ„ **μ‚¬μ©μ μ”κµ¬μ— λ§κ² μ •λ ¬(alignment)**ν•  μ μμµλ‹λ‹¤. μλ¥Ό λ“¤μ–΄ κ³ κ° μ„λΉ„μ¤ μ±—λ΄‡μ΄λΌλ©΄ κ³ κ°μ—κ² λ¬΄λ΅€ν•κ² κµ΄μ–΄μ„λ” μ• λκ² μ£ .

μΌλ°μ μΌλ΅ Geminiλ‚ Mistralκ³Ό κ°™μ€ μ™„μ„±λ μ ν’μ€ **μ„Έ λ‹¨κ³„ λ¨λ‘**λ¥Ό κ±°μΉμ§€λ§, Hugging Faceμ—μ„ μ°Ύμ„ μ μλ” λ¨λΈλ“¤μ€ μ΄ μ¤‘ ν• λ‹¨κ³„ μ΄μƒμ„ μ™„λ£ν• μƒνƒμ…λ‹λ‹¤.

μ΄ νν† λ¦¬μ–Όμ—μ„λ” [google/gemma-2-2b-it](https://huggingface.co/google/gemma-2-2b-it)μ„ κΈ°λ°μΌλ΅ ν•¨μ νΈμ¶ λ¨λΈμ„ κµ¬μ¶•ν•©λ‹λ‹¤. κΈ°λ³Έ λ¨λΈμΈ [google/gemma-2-2b](https://huggingface.co/google/gemma-2-2b) λ€μ‹  μ΄λ―Έ νμΈνλ‹λ λ¨λΈμ„ μ‚¬μ©ν•λ” μ΄μ λ” μ°λ¦¬μ ν™μ© μ‚¬λ΅€μ— λ” μ ν•©ν•κΈ° λ•λ¬Έμ…λ‹λ‹¤.

μ‚¬μ „ ν•™μµ λ¨λΈλ¶€ν„° μ‹μ‘ν•λ©΄ **μ§€μΉ¨ λ”°λ¥΄κΈ°, λ€ν™”, ν•¨μ νΈμ¶**μ„ λ¨λ‘ ν•™μµμ‹ν‚¤κΈ° μ„ν•΄ λ” λ§μ€ ν›λ ¨μ΄ ν•„μ”ν•©λ‹λ‹¤.

μ§€μΉ¨ κΈ°λ° λ¨λΈμ—μ„ μ‹μ‘ν•λ©΄ **μ°λ¦¬ λ¨λΈμ΄ ν•™μµν•΄μ•Ό ν•  μ •λ³΄λ‰μ„ μµμ†ν™”**ν•  μ μμµλ‹λ‹¤.

## LoRA(Low-Rank Adaptation)

LoRAλ” ν•™μµν•΄μ•Ό ν•  λ§¤κ°λ³€μ μλ¥Ό ν¬κ² **μ¤„μ—¬ μ£Όλ”** λ„λ¦¬ μ‚¬μ©λλ” κ°€λ³κ³  ν¨μ¨μ μΈ ν•™μµ κΈ°λ²•μ…λ‹λ‹¤.

λ¨λΈμ— **μ–΄λ‘ν„° ν•νƒμ μ μ€ μμ κ°€μ¤‘μΉ**λ¥Ό μ‚½μ…ν•μ—¬ ν•™μµν•λ” λ°©μ‹μΌλ΅ λ™μ‘ν•©λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ ν•™μµ μ†λ„κ°€ λΉ¨λΌμ§€κ³  λ©”λ¨λ¦¬ μ‚¬μ©μ΄ μ μΌλ©°, μλ°± MB μ •λ„μ μ‘μ€ λ¨λΈ κ°€μ¤‘μΉλ¥Ό μƒμ„±ν•΄ λ³΄κ΄€κ³Ό κ³µμ κ°€ μμ›”ν•©λ‹λ‹¤.

<img src="https://huggingface.co/datasets/agents-course/course-images/resolve/main/en/unit1/blog_multi-lora-serving_LoRA.gif" alt="LoRA inference" width="50%"/>

LoRAλ” μ£Όλ΅ μ„ ν• κ³„μΈµ λ“± νΈλμ¤ν¬λ¨Έ μΈµμ— λ­ν¬ λ¶„ν•΄ ν–‰λ ¬ μμ„ μ¶”κ°€ν•©λ‹λ‹¤. ν•™μµ μ¤‘μ—λ” λ‚λ¨Έμ§€ λ¨λΈμ„ "λ™κ²°"ν•κ³  μƒλ΅ μ¶”κ°€λ μ–΄λ‘ν„°μ κ°€μ¤‘μΉλ§ μ—…λ°μ΄νΈν•©λ‹λ‹¤.

μ΄λ ‡κ² ν•λ©΄ ν•™μµν•΄μ•Ό ν•  **νλΌλ―Έν„° μ**κ°€ ν¬κ² μ¤„μ–΄ μ–΄λ‘ν„° κ°€μ¤‘μΉλ§ μ—…λ°μ΄νΈν•λ©΄ λ©λ‹λ‹¤.

μ¶”λ΅  μ‹μ—λ” μ…λ ¥μ΄ μ–΄λ‘ν„°μ™€ κΈ°λ³Έ λ¨λΈμ— λ¨λ‘ μ „λ‹¬λκ±°λ‚, μ–΄λ‘ν„° κ°€μ¤‘μΉλ¥Ό κΈ°λ³Έ λ¨λΈκ³Ό λ³‘ν•©ν•μ—¬ μ¶”κ°€ μ§€μ—° μ—†μ΄ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.

LoRAλ” **λ€ν•** μ–Έμ–΄ λ¨λΈμ„ νΉμ • μ‘μ—…μ΄λ‚ λ„λ©”μΈμ— λ§κ² μ΅°μ •ν•λ©΄μ„ μμ› μ”κµ¬ μ‚¬ν•­μ„ κ΄€λ¦¬ν•κΈ° μΆ‹μµλ‹λ‹¤. μ΄λ” λ¨λΈ ν•™μµμ— **ν•„μ”ν• λ©”λ¨λ¦¬**λ¥Ό μ¤„μ΄λ” λ° λ„μ›€μ΄ λ©λ‹λ‹¤.

LoRAμ μ‘λ™ λ°©μ‹μ΄ κ¶κΈν•λ‹¤λ©΄ [μ΄ νν† λ¦¬μ–Ό](https://huggingface.co/learn/nlp-course/chapter11/4?fw=pt)μ„ ν™•μΈν•΄ λ³΄μ„Έμ”.

## ν•¨μ νΈμ¶ λ¨λΈ νμΈνλ‹ μ‹¤μµ

νν† λ¦¬μ–Ό λ…ΈνΈλ¶μ€ π‘‰ [μ—¬κΈ°](https://huggingface.co/agents-course/notebooks/blob/main/bonus-unit1/bonus-unit1.ipynb)μ—μ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

κ·Έλ¦¬κ³  [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/#fileId=https://huggingface.co/agents-course/notebooks/blob/main/bonus-unit1/bonus-unit1.ipynb)μ„ ν΄λ¦­ν•μ—¬ Colab λ…ΈνΈλ¶μ—μ„ μ‹¤ν–‰ν•΄ λ³Ό μ μμµλ‹λ‹¤.
