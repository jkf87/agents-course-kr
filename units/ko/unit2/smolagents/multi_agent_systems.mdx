<CourseFloatingBanner chapter={2}
  classNames="absolute z-10 right-0 top-0"
  notebooks={[
    {label: "Google Colab", value: "https://colab.research.google.com/#fileId=https://huggingface.co/agents-course/notebooks/blob/main/unit2/smolagents/multiagent_notebook.ipynb"},
]} />

# ë‹¤ì¤‘ ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ

ë‹¤ì¤‘ ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œì€ **ì „ë¬¸í™”ëœ ì—ì´ì „íŠ¸ë“¤ì´ ë³µì¡í•œ ì‘ì—…ì„ í˜‘ì—…**í•  ìˆ˜ ìˆê²Œ í•˜ì—¬ ëª¨ë“ˆì„±, í™•ì¥ì„±, ê²¬ê³ ì„±ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤. ë‹¨ì¼ ì—ì´ì „íŠ¸ì— ì˜ì¡´í•˜ëŠ” ëŒ€ì‹ , ê°ê°ì˜ ê³ ìœ í•œ ëŠ¥ë ¥ì„ ê°€ì§„ ì—ì´ì „íŠ¸ë“¤ ì‚¬ì´ì— ì‘ì—…ì„ ë¶„ë°°í•©ë‹ˆë‹¤.

**smolagents**ì—ì„œëŠ” Python ì½”ë“œ ìƒì„±, ì™¸ë¶€ ë„êµ¬ í˜¸ì¶œ, ì›¹ ê²€ìƒ‰ ë“± ë‹¤ì–‘í•œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ì—ì´ì „íŠ¸ë“¤ì„ ì¡°í•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ì—ì´ì „íŠ¸ë“¤ì„ ì¡°ìœ¨í•¨ìœ¼ë¡œì¨ ê°•ë ¥í•œ ì›Œí¬í”Œë¡œìš°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì¼ë°˜ì ì¸ êµ¬ì„±ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
- ì‘ì—… ìœ„ì„ì„ ìœ„í•œ **ë§¤ë‹ˆì € ì—ì´ì „íŠ¸**
- ì½”ë“œ ì‹¤í–‰ì„ ìœ„í•œ **ì½”ë“œ ì¸í„°í”„ë¦¬í„° ì—ì´ì „íŠ¸**
- ì •ë³´ ê²€ìƒ‰ì„ ìœ„í•œ **ì›¹ ê²€ìƒ‰ ì—ì´ì „íŠ¸**

ì•„ë˜ ë‹¤ì´ì–´ê·¸ë¨ì€ **ë§¤ë‹ˆì € ì—ì´ì „íŠ¸**ê°€ **ì½”ë“œ ì¸í„°í”„ë¦¬í„° ë„êµ¬**ì™€ **ì›¹ ê²€ìƒ‰ ì—ì´ì „íŠ¸**ë¥¼ ì¡°ìœ¨í•˜ê³ , ì´ë“¤ì´ ì°¨ë¡€ë¡œ `DuckDuckGoSearchTool`ê³¼ `VisitWebpageTool`ê³¼ ê°™ì€ ë„êµ¬ë“¤ì„ ì‚¬ìš©í•˜ì—¬ ê´€ë ¨ ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ëŠ” ê°„ë‹¨í•œ ë‹¤ì¤‘ ì—ì´ì „íŠ¸ ì•„í‚¤í…ì²˜ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.

<img src="https://mermaid.ink/img/pako:eNp1kc1qhTAQRl9FUiQb8wIpdNO76eKubrmFks1oRg3VSYgjpYjv3lFL_2hnMWQOJwn5sqgmelRWleUSKLAtFs09jqhtoWuYUFfFAa6QA9QDTnpzamheuhxn8pt40-6l13UtS0ddhtQXj6dbR4XUGQg6zEYasTF393KjeSDGnDJKNxzj8I_7hLW5IOSmP9CH9hv_NL-d94d4DVNg84p1EnK4qlIj5hGClySWbadT-6OdsrL02MI8sFOOVkciw8zx8kaNspxnrJQE0fXKtjBMMs3JA-MpgOQwftIE9Bzj14w-cMznI_39E9Z3p0uFoA?type=png" style='background: white;'>

## ë‹¤ì¤‘ ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œì˜ ì‘ë™ ë°©ì‹

ë‹¤ì¤‘ ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œì€ **ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° ì—ì´ì „íŠ¸**ì˜ ì¡°ìœ¨ í•˜ì— ì—¬ëŸ¬ ì „ë¬¸í™”ëœ ì—ì´ì „íŠ¸ë“¤ì´ í•¨ê»˜ ì‘ë™í•˜ëŠ” ê²ƒìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤. ì´ ì ‘ê·¼ ë°©ì‹ì€ ì„œë¡œ ë‹¤ë¥¸ ì—­í• ì„ ê°€ì§„ ì—ì´ì „íŠ¸ë“¤ ì‚¬ì´ì— ì‘ì—…ì„ ë¶„ë°°í•¨ìœ¼ë¡œì¨ ë³µì¡í•œ ì›Œí¬í”Œë¡œìš°ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, **ë‹¤ì¤‘ ì—ì´ì „íŠ¸ RAG ì‹œìŠ¤í…œ**ì€ ë‹¤ìŒê³¼ ê°™ì€ ìš”ì†Œë“¤ì„ í†µí•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- ì¸í„°ë„· ê²€ìƒ‰ì„ ìœ„í•œ **ì›¹ ì—ì´ì „íŠ¸**
- ì§€ì‹ ë² ì´ìŠ¤ì—ì„œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” **ê²€ìƒ‰ ì—ì´ì „íŠ¸**
- ì‹œê° ìë£Œë¥¼ ìƒì„±í•˜ëŠ” **ì´ë¯¸ì§€ ìƒì„± ì—ì´ì „íŠ¸**

ì´ ëª¨ë“  ì—ì´ì „íŠ¸ë“¤ì€ ì‘ì—… ìœ„ì„ê³¼ ìƒí˜¸ì‘ìš©ì„ ê´€ë¦¬í•˜ëŠ” ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°ì˜ ì§€íœ˜ í•˜ì— ì‘ë™í•©ë‹ˆë‹¤.

## ë‹¤ì¤‘ ì—ì´ì „íŠ¸ ê³„ì¸µ êµ¬ì¡°ë¡œ ë³µì¡í•œ ì‘ì—… í•´ê²°í•˜ê¸°

<Tip>
Google Colabì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” <a href="https://huggingface.co/agents-course/notebooks/blob/main/unit2/smolagents/multiagent_notebook.ipynb" target="_blank">ì´ ë…¸íŠ¸ë¶</a>ì˜ ì½”ë“œë¥¼ ë”°ë¼í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
</Tip>

ë¦¬ì…‰ì…˜ì´ ë‹¤ê°€ì˜¤ê³  ìˆìŠµë‹ˆë‹¤! ì—¬ëŸ¬ë¶„ì˜ ë„ì›€ìœ¼ë¡œ AlfredëŠ” ì´ì œ ì¤€ë¹„ë¥¼ ê±°ì˜ ë§ˆì³¤ìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ ì´ì œ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ë°°íŠ¸ëª¨ë¹Œì´ ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤. AlfredëŠ” ëŒ€ì²´ ì°¨ëŸ‰ì„ ì°¾ì•„ì•¼ í•˜ë©°, ë¹ ë¥´ê²Œ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤.

ë‹¤í–‰íˆë„ Bruce Wayneì˜ ì‚¶ì— ëŒ€í•œ ëª‡ í¸ì˜ ì „ê¸° ì˜í™”ê°€ ì œì‘ë˜ì—ˆê¸° ë•Œë¬¸ì—, AlfredëŠ” ì˜í™” ì´¬ì˜ì¥ì— ë‚¨ê²¨ì§„ ì°¨ëŸ‰ì„ ì°¾ì•„ í˜„ëŒ€ì ì¸ ê¸°ì¤€ìœ¼ë¡œ ì¬ì„¤ê³„í•  ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤. ë¬¼ë¡  ì™„ì „ ììœ¨ì£¼í–‰ ì˜µì…˜ë„ í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

í•˜ì§€ë§Œ ì´ê²ƒì€ ì „ ì„¸ê³„ì˜ ìˆ˜ë§ì€ ì´¬ì˜ ì¥ì†Œ ì–´ë””ì—ë‚˜ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê·¸ë˜ì„œ AlfredëŠ” ì—¬ëŸ¬ë¶„ì˜ ë„ì›€ì´ í•„ìš”í•©ë‹ˆë‹¤. ì´ ì‘ì—…ì„ í•´ê²°í•  ìˆ˜ ìˆëŠ” ì—ì´ì „íŠ¸ë¥¼ ë§Œë“¤ ìˆ˜ ìˆì„ê¹Œìš”?

> ğŸ‘‰ ì „ ì„¸ê³„ì˜ ëª¨ë“  ë°°íŠ¸ë§¨ ì´¬ì˜ ì¥ì†Œë¥¼ ì°¾ê³ , ë°°ë¥¼ í†µí•œ ì´ë™ ì‹œê°„ì„ ê³„ì‚°í•˜ì—¬ ì§€ë„ì— í‘œì‹œí•˜ë˜, ë°° ì´ë™ ì‹œê°„ì— ë”°ë¼ ìƒ‰ìƒì´ ë‹¬ë¼ì§€ë„ë¡ í•˜ì„¸ìš”. ë˜í•œ ë™ì¼í•œ ë°° ì´ë™ ì‹œê°„ì„ ê°€ì§„ ìŠˆí¼ì¹´ ê³µì¥ë“¤ë„ í‘œì‹œí•˜ì„¸ìš”.

ì‹œì‘í•´ë³´ê² ìŠµë‹ˆë‹¤!

ì´ ì˜ˆì œì—ëŠ” ëª‡ ê°€ì§€ ì¶”ê°€ íŒ¨í‚¤ì§€ê°€ í•„ìš”í•˜ë¯€ë¡œ ë¨¼ì € ì„¤ì¹˜í•˜ê² ìŠµë‹ˆë‹¤:

```bash
pip install 'smolagents[litellm]' plotly geopandas shapely kaleido -q
```

### ë¨¼ì € í™”ë¬¼ê¸° ì´ë™ ì‹œê°„ì„ ê³„ì‚°í•˜ëŠ” ë„êµ¬ë¥¼ ë§Œë“­ë‹ˆë‹¤.

```python
import math
from typing import Optional, Tuple

from smolagents import tool


@tool
def calculate_cargo_travel_time(
    origin_coords: Tuple[float, float],
    destination_coords: Tuple[float, float],
    cruising_speed_kmh: Optional[float] = 750.0,  # Average speed for cargo planes
) -> float:
    """
    Calculate the travel time for a cargo plane between two points on Earth using great-circle distance.

    Args:
        origin_coords: Tuple of (latitude, longitude) for the starting point
        destination_coords: Tuple of (latitude, longitude) for the destination
        cruising_speed_kmh: Optional cruising speed in km/h (defaults to 750 km/h for typical cargo planes)

    Returns:
        float: The estimated travel time in hours

    Example:
        >>> # Chicago (41.8781Â° N, 87.6298Â° W) to Sydney (33.8688Â° S, 151.2093Â° E)
        >>> result = calculate_cargo_travel_time((41.8781, -87.6298), (-33.8688, 151.2093))
    """

    def to_radians(degrees: float) -> float:
        return degrees * (math.pi / 180)

    # Extract coordinates
    lat1, lon1 = map(to_radians, origin_coords)
    lat2, lon2 = map(to_radians, destination_coords)

    # Earth's radius in kilometers
    EARTH_RADIUS_KM = 6371.0

    # Calculate great-circle distance using the haversine formula
    dlon = lon2 - lon1
    dlat = lat2 - lat1

    a = (
        math.sin(dlat / 2) ** 2
        + math.cos(lat1) * math.cos(lat2) * math.sin(dlon / 2) ** 2
    )
    c = 2 * math.asin(math.sqrt(a))
    distance = EARTH_RADIUS_KM * c

    # Add 10% to account for non-direct routes and air traffic controls
    actual_distance = distance * 1.1

    # Calculate flight time
    # Add 1 hour for takeoff and landing procedures
    flight_time = (actual_distance / cruising_speed_kmh) + 1.0

    # Format the results
    return round(flight_time, 2)


print(calculate_cargo_travel_time((41.8781, -87.6298), (-33.8688, 151.2093)))
```

### ì—ì´ì „íŠ¸ ì„¤ì •

ëª¨ë¸ ì œê³µìë¡œëŠ” Hubì˜ ìƒˆë¡œìš´ [ì¶”ë¡  ì œê³µì](https://huggingface.co/blog/inference-providers) ì¤‘ í•˜ë‚˜ì¸ Together AIë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤!

GoogleSearchToolì€ [Serper API](https://serper.dev)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹ì„ ê²€ìƒ‰í•˜ë¯€ë¡œ, í™˜ê²½ ë³€ìˆ˜ `SERPER_API_KEY`ë¥¼ ì„¤ì •í•˜ê³  `provider="serpapi"`ë¥¼ ì „ë‹¬í•˜ê±°ë‚˜, `SERPER_API_KEY`ë¥¼ ì„¤ì •í•˜ê³  `provider=serper`ë¥¼ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤.

Serp API ì œê³µìê°€ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´ `DuckDuckGoSearchTool`ì„ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ì†ë„ ì œí•œì´ ìˆë‹¤ëŠ” ì ì„ ì£¼ì˜í•˜ì„¸ìš”.

```python
import os
from PIL import Image
from smolagents import CodeAgent, GoogleSearchTool, InferenceClientModel, VisitWebpageTool

model = InferenceClientModel(model_id="Qwen/Qwen2.5-Coder-32B-Instruct", provider="together")
```

ë¨¼ì € ê°„ë‹¨í•œ ë³´ê³ ì„œë¥¼ ì œê³µí•˜ëŠ” ê¸°ì¤€ì„ ìœ¼ë¡œ ê°„ë‹¨í•œ ì—ì´ì „íŠ¸ë¥¼ ë§Œë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤.

```python
task = """Find all Batman filming locations in the world, calculate the time to transfer via cargo plane to here (we're in Gotham, 40.7128Â° N, 74.0060Â° W), and return them to me as a pandas dataframe.
Also give me some supercar factories with the same cargo plane transfer time."""
```

```python
agent = CodeAgent(
    model=model,
    tools=[GoogleSearchTool("serper"), VisitWebpageTool(), calculate_cargo_travel_time],
    additional_authorized_imports=["pandas"],
    max_steps=20,
)
```

```python
result = agent.run(task)
```

```python
result
```

ì´ ê²½ìš° ë‹¤ìŒê³¼ ê°™ì€ ì¶œë ¥ì´ ìƒì„±ë©ë‹ˆë‹¤:

```python
|  | Location                                             | Travel Time to Gotham (hours) |
|--|------------------------------------------------------|------------------------------|
| 0  | Necropolis Cemetery, Glasgow, Scotland, UK         | 8.60                         |
| 1  | St. George's Hall, Liverpool, England, UK         | 8.81                         |
| 2  | Two Temple Place, London, England, UK             | 9.17                         |
| 3  | Wollaton Hall, Nottingham, England, UK           | 9.00                         |
| 4  | Knebworth House, Knebworth, Hertfordshire, UK    | 9.15                         |
| 5  | Acton Lane Power Station, Acton Lane, Acton, UK  | 9.16                         |
| 6  | Queensboro Bridge, New York City, USA            | 1.01                         |
| 7  | Wall Street, New York City, USA                  | 1.00                         |
| 8  | Mehrangarh Fort, Jodhpur, Rajasthan, India       | 18.34                        |
| 9  | Turda Gorge, Turda, Romania                      | 11.89                        |
| 10 | Chicago, USA                                     | 2.68                         |
| 11 | Hong Kong, China                                 | 19.99                        |
| 12 | Cardington Studios, Northamptonshire, UK        | 9.10                         |
| 13 | Warner Bros. Leavesden Studios, Hertfordshire, UK | 9.13                         |
| 14 | Westwood, Los Angeles, CA, USA                  | 6.79                         |
| 15 | Woking, UK (McLaren)                             | 9.13                         |
```

ì „ìš© ê³„íš ë‹¨ê³„ë¥¼ ì¶”ê°€í•˜ê³  í”„ë¡¬í”„íŠ¸ë¥¼ ë” ì¶”ê°€í•˜ì—¬ ì´ë¥¼ ê°œì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê³„íš ë‹¨ê³„ë¥¼ í†µí•´ ì—ì´ì „íŠ¸ëŠ” ë¯¸ë¦¬ ìƒê°í•˜ê³  ë‹¤ìŒ ë‹¨ê³„ë¥¼ ê³„íší•  ìˆ˜ ìˆì–´ ë” ë³µì¡í•œ ì‘ì—…ì— ìœ ìš©í•©ë‹ˆë‹¤.

```python
agent.planning_interval = 4

detailed_report = agent.run(f"""
You're an expert analyst. You make comprehensive reports after visiting many websites.
Don't hesitate to search for many queries at once in a for loop.
For each data point that you find, visit the source url to confirm numbers.

{task}
""")

print(detailed_report)
```

```python
detailed_report
```

ì´ ê²½ìš° ë‹¤ìŒê³¼ ê°™ì€ ì¶œë ¥ì´ ìƒì„±ë©ë‹ˆë‹¤:

```python
|  | Location                                         | Travel Time (hours) |
|--|--------------------------------------------------|---------------------|
| 0  | Bridge of Sighs, Glasgow Necropolis, Glasgow, UK | 8.6                 |
| 1  | Wishart Street, Glasgow, Scotland, UK         | 8.6                 |
```

ì´ëŸ¬í•œ ë¹ ë¥¸ ë³€ê²½ ë•ë¶„ì—, ì—ì´ì „íŠ¸ì— ìì„¸í•œ í”„ë¡¬í”„íŠ¸ë¥¼ ì œê³µí•˜ê³  ê³„íš ê¸°ëŠ¥ì„ ë¶€ì—¬í•¨ìœ¼ë¡œì¨ í›¨ì”¬ ë” ê°„ê²°í•œ ë³´ê³ ì„œë¥¼ ì–»ì„ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤!

ëª¨ë¸ì˜ ì»¨í…ìŠ¤íŠ¸ ì°½ì´ ë¹ ë¥´ê²Œ ì±„ì›Œì§€ê³  ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ **ì—ì´ì „íŠ¸ì—ê²Œ ìì„¸í•œ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë‹¤ë¥¸ ê²°ê³¼ì™€ ê²°í•©í•˜ë„ë¡ ìš”ì²­í•˜ë©´, ì†ë„ê°€ ëŠë ¤ì§€ê³  í† í°ê³¼ ë¹„ìš©ì´ ë¹ ë¥´ê²Œ ì¦ê°€í•  ê²ƒì…ë‹ˆë‹¤**.

â¡ï¸ ì‹œìŠ¤í…œì˜ êµ¬ì¡°ë¥¼ ê°œì„ í•´ì•¼ í•©ë‹ˆë‹¤.

### âœŒï¸ ë‘ ì—ì´ì „íŠ¸ ì‚¬ì´ì— ì‘ì—… ë¶„í• í•˜ê¸°

ë‹¤ì¤‘ ì—ì´ì „íŠ¸ êµ¬ì¡°ëŠ” ì„œë¡œ ë‹¤ë¥¸ í•˜ìœ„ ì‘ì—… ì‚¬ì´ì— ë©”ëª¨ë¦¬ë¥¼ ë¶„ë¦¬í•  ìˆ˜ ìˆê²Œ í•˜ì—¬ ë‘ ê°€ì§€ í° ì´ì ì„ ì œê³µí•©ë‹ˆë‹¤:
- ê° ì—ì´ì „íŠ¸ëŠ” í•µì‹¬ ì‘ì—…ì— ë” ì§‘ì¤‘í•˜ì—¬ ì„±ëŠ¥ì´ í–¥ìƒë©ë‹ˆë‹¤
- ë©”ëª¨ë¦¬ë¥¼ ë¶„ë¦¬í•˜ë©´ ê° ë‹¨ê³„ì—ì„œ ì…ë ¥ í† í° ìˆ˜ê°€ ì¤„ì–´ë“¤ì–´ ì§€ì—° ì‹œê°„ê³¼ ë¹„ìš©ì´ ê°ì†Œí•©ë‹ˆë‹¤

ì „ìš© ì›¹ ê²€ìƒ‰ ì—ì´ì „íŠ¸ì™€ ì´ë¥¼ ê´€ë¦¬í•˜ëŠ” ë‹¤ë¥¸ ì—ì´ì „íŠ¸ë¡œ êµ¬ì„±ëœ íŒ€ì„ ë§Œë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤.

ë§¤ë‹ˆì € ì—ì´ì „íŠ¸ëŠ” ìµœì¢… ë³´ê³ ì„œë¥¼ ì‘ì„±í•˜ê¸° ìœ„í•œ í”Œë¡œíŒ… ê¸°ëŠ¥ì´ í•„ìš”í•˜ë¯€ë¡œ, ê³µê°„ í”Œë¡œíŒ…ì„ ìœ„í•œ `geopandas`ì™€ `shapely`ë¥¼ í¬í•¨í•œ ì¶”ê°€ ì„í¬íŠ¸ì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œì„ ë¶€ì—¬í•˜ê² ìŠµë‹ˆë‹¤.

```python
model = InferenceClientModel(
    "Qwen/Qwen2.5-Coder-32B-Instruct", provider="together", max_tokens=8096
)

web_agent = CodeAgent(
    model=model,
    tools=[
        GoogleSearchTool(provider="serper"),
        VisitWebpageTool(),
        calculate_cargo_travel_time,
    ],
    name="web_agent",
    description="Browses the web to find information",
    verbosity_level=0,
) 